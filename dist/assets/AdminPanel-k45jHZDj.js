import{r,u as Re,K as de,O as xe,Q as D,U as f,Y as ue,j as e,k as Te,Z as He,H as $e,G as Le,_ as H,$ as ae,a0 as _e,a1 as me,a2 as Ge,a3 as Ce,a4 as Ke,a5 as Ee,a6 as te,a7 as Xe,a8 as Ae,a9 as Je,P as Qe,aa as Ye,p as Ze,ab as We,X as Pe,ac as es,ad as ss,ae as ts,af as as,ag as rs,ah as ls,ai as ns}from"./index-DaCuWBGK.js";const os=[{label:"Sauda√ß√£o",text:"Ol√°! Como posso ajudar voc√™ hoje?"},{label:"Pedir Detalhes",text:"Poderia me dar mais detalhes sobre o problema que est√° enfrentando?"},{label:"Analisando",text:"Estou analisando sua conta, s√≥ um momento por favor."},{label:"Encerrar",text:"H√° algo mais em que eu possa ajudar? Se n√£o, vou encerrar este chamado."},{label:"Pagamento",text:"Para quest√µes de pagamento, verifique se seu cart√£o est√° habilitado para compras online."}],De=[{value:"financeiro",label:"Financeiro",color:"bg-green-100 text-green-700"},{value:"bug",label:"Bug/Erro",color:"bg-red-100 text-red-700"},{value:"cancelamento",label:"Cancelamento",color:"bg-gray-200 text-gray-700"},{value:"duvida",label:"D√∫vida",color:"bg-blue-100 text-blue-700"},{value:"feature",label:"Sugest√£o",color:"bg-purple-100 text-purple-700"}],is=({currentUser:m,allUsers:p})=>{const[N,I]=r.useState([]),[x,R]=r.useState(null),[re,o]=r.useState([]),[S,T]=r.useState("open"),[k,$]=r.useState(""),[L,G]=r.useState(""),[_,M]=r.useState(""),[le,U]=r.useState(!1),q=r.useRef(null),{showToast:A}=Re(),c=r.useMemo(()=>p.filter(t=>t.role&&["admin","super_admin","operational_admin","support_admin"].includes(t.role)),[p]);r.useEffect(()=>{const t=de(D(f,"tickets"),xe("updatedAt","desc")),l=ue(t,i=>{const u=[];i.forEach(b=>{u.push({id:b.id,...b.data()})}),I(u)});return()=>l()},[]),r.useEffect(()=>{if(!x){o([]);return}U(!0);const t=D(f,"users",x,"support_messages"),l=de(t,xe("timestamp","asc")),i=ue(l,b=>{const P=[];b.forEach(w=>{P.push({id:w.id,...w.data()})}),o(P),U(!1),setTimeout(()=>{var w;return(w=q.current)==null?void 0:w.scrollIntoView({behavior:"smooth"})},100)}),u=N.find(b=>b.id===x);return u&&M(u.internalNotes||""),()=>i()},[x]);const B=async t=>{if(t.preventDefault(),!(!k.trim()||!x))try{const l=D(f,"users",x,"support_messages");await _e(l,{text:k,sender:"support",timestamp:me(),read:!1});const i=H(f,"tickets",x);await ae(i,{lastMessage:k,lastMessageSender:"support",updatedAt:me(),status:"in_progress",unreadCount:0}),$("")}catch(l){console.error(l),A("Erro ao enviar mensagem.","error")}},y=async(t,l)=>{if(x)try{const i=H(f,"tickets",x);await ae(i,{[t]:l}),A("Ticket atualizado.","success")}catch{A("Erro ao atualizar.","error")}},K=async()=>{await y("internalNotes",_)},C=N.filter(t=>{const l=S==="all"?!0:t.status===S,i=t.userName.toLowerCase().includes(L.toLowerCase())||t.userEmail.toLowerCase().includes(L.toLowerCase());return l&&i}),h=N.find(t=>t.id===x),v=t=>{switch(t){case"open":return e.jsx("span",{className:"px-2 py-0.5 rounded-full text-[10px] font-bold bg-red-100 text-red-700 uppercase tracking-wide",children:"Aberto"});case"in_progress":return e.jsx("span",{className:"px-2 py-0.5 rounded-full text-[10px] font-bold bg-blue-100 text-blue-700 uppercase tracking-wide",children:"Em Andamento"});case"resolved":return e.jsx("span",{className:"px-2 py-0.5 rounded-full text-[10px] font-bold bg-green-100 text-green-700 uppercase tracking-wide",children:"Resolvido"})}};return e.jsxs("div",{className:"flex h-[calc(100vh-140px)] bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 min-w-[300px] border-r border-gray-200 flex flex-col bg-gray-50",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 bg-white",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx(Te,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm"}),e.jsx("input",{type:"text",placeholder:"Buscar usu√°rio...",className:"w-full pl-9 pr-4 py-2 bg-gray-100 border-transparent focus:bg-white focus:border-blue-500 rounded-lg text-sm transition-all outline-none border",value:L,onChange:t=>G(t.target.value)})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:["open","in_progress","resolved","all"].map(t=>e.jsx("button",{onClick:()=>T(t),className:`px-3 py-1.5 rounded-lg text-xs font-bold whitespace-nowrap transition-colors ${S===t?"bg-gray-800 text-white shadow-md":"bg-gray-200 text-gray-600 hover:bg-gray-300"}`,children:t==="all"?"Todos":t==="open"?"Abertos":t==="in_progress"?"Andamento":"Resolvidos"},t))})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:C.length===0?e.jsx("div",{className:"p-8 text-center text-gray-400 text-sm",children:"Nenhum ticket encontrado."}):C.map(t=>{var l,i,u;return e.jsxs("div",{onClick:()=>R(t.id),className:`p-4 border-b border-gray-100 cursor-pointer hover:bg-white transition-colors relative ${x===t.id?"bg-white border-l-4 border-l-blue-600 shadow-sm":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h4",{className:`font-bold text-sm ${t.unreadCount>0?"text-gray-900":"text-gray-700"}`,children:t.userName}),e.jsx("span",{className:"text-[10px] text-gray-400",children:new Date(((i=(l=t.updatedAt)==null?void 0:l.toMillis)==null?void 0:i.call(l))||Date.now()).toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})})]}),e.jsxs("p",{className:`text-xs truncate mb-2 ${t.unreadCount>0?"font-bold text-gray-800":"text-gray-500"}`,children:[t.lastMessageSender==="user"?"üë§ ":"Support: "," ",t.lastMessage]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex gap-1",children:[v(t.status),t.tags&&t.tags.length>0&&e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[9px] font-bold uppercase ${((u=De.find(b=>b.value===t.tags[0]))==null?void 0:u.color)||"bg-gray-100"}`,children:t.tags[0].slice(0,3)})]}),t.unreadCount>0&&e.jsx("span",{className:"bg-red-500 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full min-w-[18px] text-center",children:t.unreadCount})]})]},t.id)})})]}),h?e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 bg-white relative",children:[e.jsxs("div",{className:"h-16 border-b border-gray-100 flex justify-between items-center px-6 bg-white shrink-0",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-800",children:h.userName}),e.jsx("p",{className:"text-xs text-gray-500",children:h.userEmail})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("select",{value:h.status,onChange:t=>y("status",t.target.value),className:"bg-gray-50 border border-gray-200 text-xs font-bold rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"open",children:"Aberto"}),e.jsx("option",{value:"in_progress",children:"Em Andamento"}),e.jsx("option",{value:"resolved",children:"Resolvido"})]})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-50/50 space-y-4 custom-scrollbar",children:[re.map(t=>{var i;const l=t.sender!=="user";return e.jsx("div",{className:`flex ${l?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[70%] p-3 rounded-2xl text-sm shadow-sm ${l?"bg-blue-600 text-white rounded-tr-none":"bg-white border border-gray-200 text-gray-700 rounded-tl-none"}`,children:[e.jsx("p",{children:t.text}),e.jsx("span",{className:`text-[10px] block mt-1 opacity-70 ${l?"text-blue-100 text-right":"text-gray-400"}`,children:(i=t.timestamp)!=null&&i.toDate?t.timestamp.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"..."})]})},t.id)}),e.jsx("div",{ref:q})]}),e.jsxs("div",{className:"p-4 border-t border-gray-100 bg-white",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto mb-3 pb-1 scrollbar-hide",children:os.map((t,l)=>e.jsx("button",{onClick:()=>$(t.text),className:"px-3 py-1.5 bg-gray-50 hover:bg-gray-100 border border-gray-200 rounded-full text-xs text-gray-600 whitespace-nowrap transition-colors",children:t.label},l))}),e.jsxs("form",{onSubmit:B,className:"relative",children:[e.jsx("input",{type:"text",value:k,onChange:t=>$(t.target.value),placeholder:"Escreva uma resposta...",className:"w-full pl-4 pr-12 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:bg-white transition-all text-sm"}),e.jsx("button",{type:"submit",disabled:!k.trim(),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:e.jsx(He,{className:"text-sm"})})]})]})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-400 bg-gray-50",children:[e.jsx($e,{className:"text-6xl mb-4 opacity-20"}),e.jsx("p",{className:"font-medium",children:"Selecione um ticket para iniciar o atendimento"})]}),h&&e.jsxs("div",{className:"w-1/4 min-w-[250px] border-l border-gray-200 bg-white flex flex-col p-5 overflow-y-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide block mb-2",children:"Atribuir a"}),e.jsxs("select",{value:h.assignedTo||"",onChange:t=>y("assignedTo",t.target.value),className:"w-full p-2 bg-gray-50 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none",children:[e.jsx("option",{value:"",children:"N√£o atribu√≠do"}),c.map(t=>e.jsx("option",{value:t.uid,children:t.name},t.uid))]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide block mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:De.map(t=>{var i;const l=(i=h.tags)==null?void 0:i.includes(t.value);return e.jsx("button",{onClick:()=>{const u=h.tags||[],b=l?u.filter(P=>P!==t.value):[...u,t.value];y("tags",b)},className:`px-2 py-1 rounded-md text-xs font-medium border transition-all ${l?t.color+" border-transparent ring-1 ring-offset-1":"bg-white border-gray-200 text-gray-500 hover:bg-gray-50"}`,children:t.label},t.value)})})]}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide block mb-2 flex items-center gap-1",children:[e.jsx(Le,{className:"text-sm"})," Nota Interna (Privado)"]}),e.jsx("textarea",{className:"w-full flex-1 p-3 bg-yellow-50 border border-yellow-200 rounded-xl text-sm text-gray-700 resize-none focus:ring-2 focus:ring-yellow-400 outline-none placeholder-yellow-700/30",placeholder:"Escreva observa√ß√µes sobre o cliente ou problema...",value:_,onChange:t=>M(t.target.value),onBlur:K}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-2 text-right",children:"Salvo automaticamente ao sair."})]})]})]})},Ie=m=>{if(!m)return"-";const p=m.split("T")[0],[N,I,x]=p.split("-");return`${x}/${I}/${N}`},cs=m=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(m),xs=({currentUser:m})=>{const[p,N]=r.useState([]),[I,x]=r.useState(!0),[R,re]=r.useState(""),{showToast:o}=Re(),{pricing:S,loading:T}=Ge(),[k,$]=r.useState([]),[L,G]=r.useState(!1),[_,M]=r.useState(""),[le,U]=r.useState(""),[q,A]=r.useState(!1),[c,B]=r.useState(null),[y,K]=r.useState(""),[C,h]=r.useState(""),[v,t]=r.useState(""),[l,i]=r.useState("user"),[u,b]=r.useState(""),[P,w]=r.useState(!1),[X,pe]=r.useState(""),[J,be]=r.useState(""),[Q,ge]=r.useState(""),[ne,he]=r.useState("user"),[fe,ye]=r.useState(!1),[j,Y]=r.useState("users"),Z=m.role||"user",E=Z==="super_admin"||Z==="admin",W=Z==="operational_admin",oe=E,je=E,ie=E||W,ce=E||W,Ne=E||W,ee=E||W;r.useEffect(()=>{!T&&S&&(M(S.monthlyPrice.toString()),U(S.annualPrice.toString()))},[T,S]);const z=async(s,a,n)=>{try{await _e(D(f,"admin_logs"),{adminId:m.uid,adminName:m.name||"Admin",action:s,details:a,targetUserId:(n==null?void 0:n.uid)||null,targetUserName:(n==null?void 0:n.name)||null,timestamp:me()})}catch(d){console.error("Failed to log admin action:",d)}},ve=async()=>{try{x(!0);const s=await ts(D(f,"users")),a=[];s.forEach(n=>{const d=n.data();a.push({...d,uid:n.id,role:d.role||"user",status:d.status||"active"})}),N(a)}catch(s){console.error("Erro ao buscar usu√°rios:",s),o("Erro ao carregar lista de usu√°rios.","error")}finally{x(!1)}};r.useEffect(()=>{ve()},[o]),r.useEffect(()=>{if(j==="logs"&&ee){G(!0);const s=de(D(f,"admin_logs"),xe("timestamp","desc")),a=ue(s,n=>{const d=[];n.forEach(g=>{d.push({id:g.id,...g.data()})}),$(d),G(!1)});return()=>a()}},[j,ee]);const we=r.useMemo(()=>{const s=R.toLowerCase();return p.filter(a=>a.name.toLowerCase().includes(s)||a.email.toLowerCase().includes(s)||a.uid.toLowerCase().includes(s))},[p,R]),se=r.useMemo(()=>{const s=new Date;return s.setHours(0,0,0,0),{total:p.length,active:p.filter(a=>a.status==="active").length,blocked:p.filter(a=>a.status==="blocked").length,expired:p.filter(a=>{if(!a.subscriptionExpiresAt)return!1;const[n,d,g]=a.subscriptionExpiresAt.split("-").map(Number);return new Date(n,d-1,g)<s}).length}},[p]),Me=async s=>{if(!Ne){o("Sem permiss√£o para bloquear usu√°rios.","error");return}if(s.uid===m.uid){o("Voc√™ n√£o pode bloquear a si mesmo.","error");return}if((s.role==="super_admin"||s.role==="admin")&&!E){o("Apenas Super Admins podem gerenciar outros Admins.","error");return}const a=s.status==="active"?"blocked":"active";try{const n=H(f,"users",s.uid);await ae(n,{status:a}),await z(a==="blocked"?"Bloqueio de Usu√°rio":"Desbloqueio de Usu√°rio",`Status alterado de ${s.status} para ${a}`,s),N(d=>d.map(g=>g.uid===s.uid?{...g,status:a}:g)),o(`Usu√°rio ${a==="active"?"desbloqueado":"bloqueado"} com sucesso.`,"success")}catch{o("Erro ao atualizar status.","error")}},Ue=s=>{ie&&(B(s),h(s.name),K(s.email),t(s.subscriptionExpiresAt||""),i(s.role||"user"),b(s.internalNotes||""))},Se=s=>{let a=new Date;if(v){const[d,g,F]=v.split("-").map(Number),V=new Date(d,g-1,F);V>new Date&&(a=V)}a.setMonth(a.getMonth()+s);const n=a.toISOString().split("T")[0];t(n)},qe=()=>{const s=new Date;s.setDate(s.getDate()-1),t(s.toISOString().split("T")[0]),o("Data definida para ontem. Salve para confirmar o cancelamento.","info")},Be=async()=>{if(c)try{const s=H(f,"users",c.uid);await ae(s,{name:C,email:y,subscriptionExpiresAt:v||null,role:l,internalNotes:u});const a=[];C!==c.name&&a.push(`Nome: ${C}`),y!==c.email&&a.push(`Email: ${y}`),l!==c.role&&a.push(`Role: ${l}`),v!==(c.subscriptionExpiresAt||"")&&a.push(`Assinatura: ${v||"Vital√≠cio"}`),u!==(c.internalNotes||"")&&a.push("Notas Internas atualizadas"),a.length>0&&await z("Edi√ß√£o de Usu√°rio",a.join(", "),c),N(n=>n.map(d=>d.uid===c.uid?{...d,name:C,email:y,subscriptionExpiresAt:v||null,role:l,internalNotes:u}:d)),o("Dados do usu√°rio atualizados com sucesso.","success"),B(null)}catch(s){console.error(s),o("Erro ao salvar altera√ß√µes no banco de dados.","error")}},ze=async s=>{if(s.preventDefault(),!!ce){if(!X||!J||!Q){o("Preencha todos os campos.","error");return}if(Q.length<6){o("A senha deve ter pelo menos 6 caracteres.","error");return}ye(!0);try{const a=await ns(X,J,Q,ne);a.success?(await z("Cria√ß√£o de Usu√°rio",`Novo usu√°rio criado com role: ${ne}`,{name:X,email:J}),o(a.message,"success"),w(!1),pe(""),be(""),ge(""),he("user"),await ve()):o(a.message,"error")}catch(a){console.error(a),o("Erro ao criar usu√°rio.","error")}finally{ye(!1)}}},Oe=async()=>{if(!oe)return;const s=parseFloat(_.replace(",",".")),a=parseFloat(le.replace(",","."));if(isNaN(s)||isNaN(a)){o("Por favor, insira valores v√°lidos.","error");return}A(!0);try{const n=H(f,"settings","pricing");await rs(n,{monthlyPrice:s,annualPrice:a},{merge:!0}),await z("Altera√ß√£o de Pre√ßos",`Mensal: ${s}, Anual: ${a}`),o("Pre√ßos atualizados com sucesso! Refletindo no app em instantes.","success")}catch(n){console.error(n),o("Erro ao atualizar pre√ßos.","error")}finally{A(!1)}},Fe=async()=>{if(!c)return;const{success:s,message:a}=await ls(c.email);s&&await z("Reset de Senha","Email de redefini√ß√£o enviado",c),o(a,s?"success":"error")},Ve=s=>{navigator.clipboard.writeText(s),o("ID copiado!","success")},O="w-full p-3 bg-white text-gray-800 rounded-xl border border-gray-200 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",ke=s=>{switch(s){case"super_admin":case"admin":return e.jsxs("span",{className:"text-[10px] bg-purple-100 text-purple-800 px-2 py-0.5 rounded-full font-bold border border-purple-200 uppercase tracking-wider flex items-center gap-1 w-fit",children:[e.jsx(as,{className:"text-xs"})," Super Admin"]});case"operational_admin":return e.jsxs("span",{className:"text-[10px] bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full font-bold border border-blue-200 uppercase tracking-wider flex items-center gap-1 w-fit",children:[e.jsx(te,{className:"text-xs"})," Operacional"]});case"support_admin":return e.jsxs("span",{className:"text-[10px] bg-green-100 text-green-800 px-2 py-0.5 rounded-full font-bold border border-green-200 uppercase tracking-wider flex items-center gap-1 w-fit",children:[e.jsx($e,{className:"text-xs"})," Suporte"]});default:return e.jsx("span",{className:"text-[10px] bg-gray-100 text-gray-600 px-2 py-0.5 rounded-full font-bold border border-gray-200 uppercase tracking-wider w-fit",children:"Usu√°rio"})}};return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:["Painel Administrativo",ke(Z)]}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Gest√£o de sistema"})]}),e.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-xl mt-4 sm:mt-0 shadow-inner overflow-x-auto",children:[e.jsxs("button",{onClick:()=>Y("users"),className:`px-6 py-2.5 text-sm font-bold rounded-lg transition-all flex items-center gap-2 ${j==="users"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(Ce,{className:"text-lg"}),"Usu√°rios"]}),e.jsxs("button",{onClick:()=>Y("support"),className:`px-6 py-2.5 text-sm font-bold rounded-lg transition-all flex items-center gap-2 ${j==="support"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(Ke,{className:"text-lg"}),"Suporte"]}),ee&&e.jsxs("button",{onClick:()=>Y("logs"),className:`px-6 py-2.5 text-sm font-bold rounded-lg transition-all flex items-center gap-2 ${j==="logs"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(Ee,{className:"text-lg"}),"Auditoria"]}),oe&&e.jsxs("button",{onClick:()=>Y("settings"),className:`px-6 py-2.5 text-sm font-bold rounded-lg transition-all flex items-center gap-2 ${j==="settings"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(te,{className:"text-lg"}),"Configura√ß√µes"]})]})]}),j==="support"&&e.jsx("div",{className:"animate-fade-in",children:e.jsx(is,{currentUser:m,allUsers:p})}),j==="logs"&&ee&&e.jsx("div",{className:"animate-fade-in",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden border border-gray-200",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-center gap-2",children:[e.jsx(Ee,{className:"text-gray-400"}),e.jsx("h2",{className:"font-bold text-gray-700",children:"Hist√≥rico de A√ß√µes"})]}),e.jsx("div",{className:"overflow-x-auto max-h-[600px] overflow-y-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Data"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Admin"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:"A√ß√£o"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Alvo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Detalhes"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:L?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("span",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"})})})}):k.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500",children:"Nenhum registro encontrado."})}):k.map(s=>{var a;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-xs text-gray-500",children:(a=s.timestamp)!=null&&a.toDate?s.timestamp.toDate().toLocaleString("pt-BR"):"..."}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-xs font-bold text-blue-600",children:s.adminName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-[10px] leading-5 font-semibold rounded-full 
                                                        ${s.action.includes("Bloqueio")?"bg-red-100 text-red-800":s.action.includes("Cria√ß√£o")?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:s.action})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-xs text-gray-600",children:s.targetUserName||"-"}),e.jsx("td",{className:"px-6 py-4 text-xs text-gray-500 max-w-xs truncate",title:s.details,children:s.details})]},s.id)})})]})})]})}),j==="users"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm flex items-center space-x-3 border border-gray-100",children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center bg-blue-100 rounded-full text-blue-600 flex-shrink-0",children:e.jsx(Ce,{className:"text-xl"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Total"}),e.jsx("p",{className:"text-xl font-bold",children:se.total})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm flex items-center space-x-3 border border-gray-100",children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center bg-green-100 rounded-full text-green-600 flex-shrink-0",children:e.jsx(Xe,{className:"text-xl"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Ativos"}),e.jsx("p",{className:"text-xl font-bold",children:se.active})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm flex items-center space-x-3 border border-gray-100",children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center bg-red-100 rounded-full text-red-600 flex-shrink-0",children:e.jsx(Ae,{className:"text-xl"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Bloqueados"}),e.jsx("p",{className:"text-xl font-bold",children:se.blocked})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm flex items-center space-x-3 border border-gray-100",children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center bg-orange-100 rounded-full text-orange-600 flex-shrink-0",children:e.jsx(Je,{className:"text-xl"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Vencidos"}),e.jsx("p",{className:"text-xl font-bold",children:se.expired})]})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm flex flex-col md:flex-row justify-between items-center gap-4 border border-gray-200",children:[e.jsxs("div",{className:"relative w-full md:w-1/2",children:[e.jsx(Te,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 text-xl"}),e.jsx("input",{type:"text",placeholder:"Buscar por Nome, Email ou ID...",value:R,onChange:s=>re(s.target.value),className:"w-full pl-12 pr-4 py-3 bg-gray-50 text-gray-800 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all shadow-inner text-sm"})]}),ce&&e.jsxs("button",{onClick:()=>w(!0),className:"w-full md:w-auto bg-green-600 text-white font-bold py-3 px-6 rounded-xl hover:bg-green-700 transition-colors flex items-center justify-center gap-2 shadow-md active:scale-95 text-sm",children:[e.jsx(Qe,{className:"text-xl"}),"Novo Usu√°rio"]})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden border border-gray-200",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Usu√°rio"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Plano Atual"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Criado em"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider text-right",children:"A√ß√µes"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:I?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-6 py-12 text-center text-gray-500",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("span",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})})}):we.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-6 py-12 text-center text-gray-500 font-medium",children:"Nenhum usu√°rio encontrado."})}):we.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex-shrink-0 h-10 w-10 relative",children:[e.jsx("img",{className:"h-10 w-10 rounded-full object-cover border border-gray-200",src:s.profileImage||"https://gravatar.com/avatar/?d=mp",alt:""}),e.jsx("span",{className:`absolute bottom-0 right-0 block h-2.5 w-2.5 rounded-full ring-2 ring-white ${s.status==="active"?"bg-green-400":"bg-red-400"}`})]}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm font-bold text-gray-900",children:s.name}),s.internalNotes&&e.jsx("span",{className:"material-symbols-outlined text-[10px] text-yellow-600",title:"Possui observa√ß√µes internas",children:"description"})]}),e.jsx("div",{className:"text-xs text-gray-500",children:s.email}),e.jsxs("button",{onClick:()=>Ve(s.uid),className:"text-[10px] text-gray-400 font-mono hover:text-blue-500 cursor-pointer flex items-center gap-1 mt-0.5",title:"Clique para copiar UID",children:["ID: ",s.uid.substring(0,8),"... ",e.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"content_copy"})]}),e.jsx("div",{className:"mt-1",children:ke(s.role||"user")})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.subscriptionExpiresAt?(()=>{const[a,n,d]=s.subscriptionExpiresAt.split("-").map(Number),g=new Date(a,n-1,d),F=new Date;F.setHours(0,0,0,0);const V=g<F;return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:`text-sm font-bold ${V?"text-red-600":"text-blue-600"}`,children:V?"Expirado":"Premium"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Vence: ",Ie(s.subscriptionExpiresAt)]})]})})():e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold text-gray-600",children:"Free / Vital√≠cio"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Sem validade"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:Ie(s.createdAt)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end items-center space-x-2",children:[Ne&&e.jsx("button",{onClick:()=>Me(s),className:`p-2 rounded-lg transition-colors border ${s.status==="active"?"text-gray-400 hover:text-red-600 hover:border-red-200 bg-white border-gray-200":"text-red-600 bg-red-50 border-red-200"}`,title:s.status==="active"?"Suspender Conta":"Reativar Conta",disabled:s.uid===m.uid,children:s.status==="active"?e.jsx(Ye,{className:"text-lg"}):e.jsx(Ae,{className:"text-lg"})}),ie?e.jsx("button",{onClick:()=>Ue(s),className:"p-2 rounded-lg bg-blue-50 text-blue-600 hover:bg-blue-100 transition-colors border border-blue-100",title:"Editar Usu√°rio / Assinatura / Resetar Senha",children:e.jsx(Ze,{className:"text-lg"})}):e.jsx("button",{className:"p-2 rounded-lg bg-gray-50 text-gray-400 cursor-not-allowed",title:"Apenas visualiza√ß√£o",children:e.jsx("span",{className:"material-symbols-outlined text-lg",children:"visibility"})})]})})]},s.uid))})]})})})]}),j==="settings"&&oe&&e.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-sm border border-gray-200 max-w-2xl mx-auto animate-fade-in",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-4 flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg text-blue-600",children:e.jsx(We,{})}),"Configura√ß√£o de Pre√ßos"]}),e.jsx("p",{className:"text-gray-600 mb-8 leading-relaxed border-b border-gray-100 pb-4",children:"Atualize os valores dos planos de assinatura. Estas altera√ß√µes refletem imediatamente na Landing Page e na tela de assinatura do app."}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 uppercase tracking-wide",children:"Plano Mensal (R$)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 font-bold",children:"R$"}),e.jsx("input",{type:"number",step:"0.01",value:_,onChange:s=>M(s.target.value),className:"w-full pl-12 pr-4 py-4 border border-gray-200 rounded-xl bg-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all font-mono text-xl shadow-sm",placeholder:"Ex: 24.90"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 uppercase tracking-wide",children:"Plano Anual (R$)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 font-bold",children:"R$"}),e.jsx("input",{type:"number",step:"0.01",value:le,onChange:s=>U(s.target.value),className:"w-full pl-12 pr-4 py-4 border border-gray-200 rounded-xl bg-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all font-mono text-xl shadow-sm",placeholder:"Ex: 149.88"})]})]})]}),e.jsx("div",{className:"mt-10 flex justify-end",children:e.jsx("button",{onClick:Oe,disabled:q||T,className:"bg-blue-600 text-white font-bold py-4 px-8 rounded-xl hover:bg-blue-700 transition-all shadow-lg shadow-blue-200 flex items-center gap-2 disabled:bg-blue-300 transform active:scale-95",children:q?e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Salvando..."]}):"Salvar Novos Pre√ßos"})})]}),c&&ie&&e.jsx("div",{className:"fixed inset-0 bg-gray-900/40 flex justify-center items-center z-50 p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 max-h-[90vh] overflow-y-auto animate-fade-in border border-gray-100",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 border-b border-gray-100 pb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Gerenciar Usu√°rio"}),e.jsx("button",{onClick:()=>B(null),className:"text-gray-400 hover:text-gray-600 bg-gray-50 p-1.5 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(Pe,{className:"text-xl"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wide mb-1.5",children:"Nome"}),e.jsx("input",{type:"text",value:C,onChange:s=>h(s.target.value),className:O})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-100",children:[e.jsxs("label",{className:"block text-xs font-bold text-blue-800 uppercase tracking-wide mb-1.5 flex items-center gap-2",children:[e.jsx(es,{})," Email de Login"]}),e.jsx("input",{type:"email",value:y,onChange:s=>K(s.target.value),className:"w-full p-3 border border-blue-200 rounded-lg bg-white focus:ring-2 focus:ring-blue-500 outline-none text-sm"})]})]}),c.lastPayment&&e.jsxs("div",{className:"bg-green-50 p-3 rounded-xl border border-green-100 text-xs",children:[e.jsxs("h4",{className:"font-bold text-green-800 mb-1 flex items-center gap-1",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"payments"})," √öltimo Pagamento"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-green-700",children:[e.jsxs("p",{children:["Data: ",e.jsx("strong",{children:new Date(c.lastPayment.date).toLocaleDateString("pt-BR")})]}),e.jsxs("p",{children:["Valor: ",e.jsx("strong",{children:cs(c.lastPayment.amount)})]}),e.jsxs("p",{className:"col-span-2",children:["Produto: ",e.jsx("strong",{children:c.lastPayment.product||"Desconhecido"})]})]})]}),e.jsxs("div",{className:"border-t border-gray-100 pt-4",children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wide mb-2 flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-base",children:"calendar_month"})," Controle de Assinatura"]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("input",{type:"date",value:v,onChange:s=>t(s.target.value),className:O}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("button",{onClick:()=>Se(1),className:"px-2 py-2 bg-blue-50 text-blue-600 text-xs font-bold rounded-lg hover:bg-blue-100 border border-blue-100 transition-colors",title:"Liberar 30 dias",children:"+1 M√™s"}),e.jsx("button",{onClick:()=>Se(12),className:"px-2 py-2 bg-blue-50 text-blue-600 text-xs font-bold rounded-lg hover:bg-blue-100 border border-blue-100 transition-colors",title:"Liberar 1 Ano",children:"+1 Ano"}),e.jsx("button",{onClick:()=>t(""),className:"px-2 py-2 bg-purple-50 text-purple-600 text-xs font-bold rounded-lg hover:bg-purple-100 border border-purple-100 transition-colors",title:"Tornar Vital√≠cio",children:"Vital√≠cio"})]}),e.jsxs("button",{onClick:qe,className:"w-full py-2 bg-red-50 text-red-600 text-xs font-bold rounded-lg hover:bg-red-100 border border-red-100 transition-colors flex items-center justify-center gap-1",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"cancel"})," Cancelar Assinatura (Expirar Hoje)"]})]})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-xl border border-yellow-100",children:[e.jsxs("label",{className:"block text-xs font-bold text-yellow-800 uppercase tracking-wide mb-1.5 flex items-center gap-2",children:[e.jsx(Le,{className:"text-sm"})," Observa√ß√µes Internas (Admin)"]}),e.jsx("textarea",{value:u,onChange:s=>b(s.target.value),className:"w-full p-3 border border-yellow-200 rounded-lg bg-white focus:ring-2 focus:ring-yellow-400 outline-none text-xs resize-none h-20 placeholder-yellow-800/30",placeholder:"Ex: Usu√°rio liberado 30 dias por erro no gateway. N√£o informado ao cliente."})]}),je&&e.jsxs("div",{className:"border-t border-gray-100 pt-4",children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wide mb-1.5 flex items-center gap-2",children:[e.jsx(te,{className:"text-lg"})," Fun√ß√£o (Role)"]}),e.jsxs("select",{value:l,onChange:s=>i(s.target.value),className:"w-full p-3 border border-gray-200 rounded-lg bg-white focus:ring-2 focus:ring-blue-500 outline-none text-sm appearance-none",disabled:c.uid===m.uid,children:[e.jsx("option",{value:"user",children:"Usu√°rio Comprador"}),e.jsx("option",{value:"support_admin",children:"Admin Suporte"}),e.jsx("option",{value:"operational_admin",children:"Admin Operacional"}),e.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-100 flex flex-col gap-3",children:[e.jsxs("button",{onClick:Fe,className:"flex items-center justify-center gap-2 w-full py-3 text-gray-600 border border-gray-200 rounded-xl hover:bg-gray-50 text-sm font-bold transition-colors",children:[e.jsx(ss,{})," Enviar Email de Reset de Senha"]}),e.jsx("button",{onClick:Be,className:"w-full py-3.5 bg-blue-600 text-white rounded-xl hover:bg-blue-700 font-bold transition-all shadow-md active:scale-95",children:"Salvar Altera√ß√µes"})]})]})]})}),P&&ce&&e.jsx("div",{className:"fixed inset-0 bg-gray-900/40 flex justify-center items-center z-50 p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 max-h-[90vh] overflow-y-auto animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 border-b border-gray-100 pb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Criar Novo Usu√°rio"}),e.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-600 bg-gray-50 p-1.5 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(Pe,{className:"text-xl"})})]}),e.jsxs("form",{onSubmit:ze,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wide mb-1.5",children:"Nome Completo"}),e.jsx("input",{type:"text",value:X,onChange:s=>pe(s.target.value),className:O,placeholder:"Ex: Jo√£o Silva",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wide mb-1.5",children:"Email de Login"}),e.jsx("input",{type:"email",value:J,onChange:s=>be(s.target.value),className:O,placeholder:"exemplo@email.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wide mb-1.5",children:"Senha Tempor√°ria"}),e.jsx("input",{type:"password",value:Q,onChange:s=>ge(s.target.value),className:O,placeholder:"M√≠nimo 6 caracteres",required:!0,minLength:6})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-xl border border-yellow-200",children:[e.jsxs("label",{className:"block text-xs font-bold text-yellow-800 uppercase tracking-wide mb-1.5 flex items-center gap-2",children:[e.jsx(te,{className:"text-lg"})," Fun√ß√£o (Role)"]}),e.jsxs("select",{value:ne,onChange:s=>he(s.target.value),className:"w-full p-3 border border-yellow-300 rounded-lg bg-white focus:ring-2 focus:ring-yellow-500 outline-none appearance-none",children:[e.jsx("option",{value:"user",children:"Usu√°rio Comprador"}),je&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"support_admin",children:"Admin Suporte"}),e.jsx("option",{value:"operational_admin",children:"Admin Operacional"}),e.jsx("option",{value:"super_admin",children:"Super Admin"})]})]})]}),e.jsx("div",{className:"pt-4 border-t border-gray-100",children:e.jsx("button",{type:"submit",disabled:fe,className:"w-full py-3.5 bg-green-600 text-white rounded-xl hover:bg-green-700 font-bold transition-all shadow-md disabled:bg-green-300 flex items-center justify-center active:scale-95",children:fe?e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Criando..."]}):"Criar Usu√°rio"})})]})]})})]})};export{xs as AdminPanel};
//# sourceMappingURL=AdminPanel-k45jHZDj.js.map
