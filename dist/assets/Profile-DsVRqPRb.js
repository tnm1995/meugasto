import{r as y,u as S,w as C,b as G,j as e,T as L,x as P,y as p,z as T,G as k,H as B,J as D}from"./index-DaCuWBGK.js";const F=(o,n,c,u,h="image/jpeg")=>new Promise((b,m)=>{const d=new FileReader;d.readAsDataURL(o),d.onload=x=>{var a;const t=new Image;t.src=(a=x.target)==null?void 0:a.result,t.onload=()=>{const l=document.createElement("canvas");let s=t.width,r=t.height;s>r?s>n&&(r=Math.round(r*=n/s),s=n):r>c&&(s=Math.round(s*=c/r),r=c),l.width=s,l.height=r;const g=l.getContext("2d");if(!g)return m(new Error("Could not get canvas context."));g.drawImage(t,0,0,s,r),b(l.toDataURL(h,u))},t.onerror=l=>m(l)},d.onerror=x=>m(x)}),U=({userProfile:o,handleLogout:n,onManageSubscription:c,onUpdateProfileImage:u,isLoading:h,onOpenPrivacyPolicy:b,onOpenTermsOfService:m,onOpenSupport:d})=>{var v;const[x,t]=y.useState(Date.now()),{showToast:a}=S(),l=y.useCallback(async f=>{var w;const i=(w=f.target.files)==null?void 0:w[0];if(i){if(!i.type.startsWith("image/")){a("Formato de arquivo inválido. Por favor, selecione uma imagem (JPG, PNG, GIF).","error"),t(Date.now());return}const A=5*1024*1024;if(i.size>A){a(`A imagem original é muito grande (${Math.round(i.size/(1024*1024))}MB). Selecione uma imagem menor (limite de 5MB).`,"error"),t(Date.now());return}try{const j=await F(i,512,512,.4,i.type),E=900*1024;if(j.length>E){const _=Math.round(j.length/1024),M=Math.round(E/1024);a(`A imagem (${_}KB) ainda é muito grande após a otimização para 512x512 pixels. O limite é de ${M}KB. Por favor, tente uma imagem com menos detalhes ou menor resolução original.`,"error"),t(Date.now());return}await u(j)?a("Foto de perfil atualizada com sucesso!","success"):a("Erro ao atualizar foto de perfil no servidor. Tente novamente.","error"),t(Date.now())}catch(I){console.error("Profile Debug: Erro ao comprimir ou fazer upload da imagem:",I),a("Erro ao atualizar foto de perfil. Verifique o formato ou tente uma imagem menor.","error")}}},[u,a]),s=y.useCallback(()=>{const f=document.getElementById("profile-image-upload");f&&f.click()},[]),r=o.profileImage||C,g=o.name||((v=o.email)==null?void 0:v.split("@")[0])||"Usuário",N=G(o.xp||0);return h&&(!o||!o.uid)?e.jsxs("div",{className:"p-4 flex flex-col items-center justify-center min-h-[calc(100vh-120px)] text-center text-gray-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600 mb-4"}),e.jsx("p",{className:"text-lg",children:"Carregando perfil..."})]}):e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm flex flex-col items-center",children:[e.jsxs("div",{className:"relative w-28 h-28 mb-4 shrink-0 aspect-square",children:[e.jsx("img",{src:r,alt:"Foto de Perfil",className:"w-full h-full rounded-full object-cover border-4 border-blue-200"}),e.jsx("button",{onClick:s,className:"absolute bottom-0 right-0 bg-blue-500 text-white rounded-full p-2 text-sm shadow-md hover:bg-blue-600 transition-colors shrink-0 aspect-square flex items-center justify-center","aria-label":"Alterar foto de perfil",children:e.jsx("span",{className:"material-symbols-outlined",children:"photo_camera"})}),e.jsx("input",{id:"profile-image-upload",type:"file",accept:"image/*",className:"hidden",onChange:l,"aria-label":"Upload de nova foto de perfil"},x)]}),e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:g}),e.jsx("p",{className:"text-gray-500 text-sm mb-4",children:o.email}),e.jsxs("div",{className:"flex items-center gap-2 bg-yellow-50 px-4 py-2 rounded-full border border-yellow-100",children:[e.jsx(L,{className:"text-yellow-600"}),e.jsxs("span",{className:"text-sm font-bold text-yellow-800",children:[N.title," (Nível ",N.level,")"]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Configurações"}),e.jsxs("button",{onClick:c,className:"flex items-center justify-between w-full py-3 px-2 rounded-lg hover:bg-gray-50 transition-colors","aria-label":"Gerenciar assinatura premium",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{className:"text-blue-600 text-xl mr-3"}),e.jsx("span",{className:"font-medium text-gray-700",children:"Assinatura Premium"})]}),e.jsx(p,{className:"text-lg text-gray-400"})]}),e.jsxs("button",{onClick:b,className:"flex items-center justify-between w-full py-3 px-2 rounded-lg hover:bg-gray-50 transition-colors","aria-label":"Ver política de privacidade",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{className:"text-purple-600 text-xl mr-3"}),e.jsx("span",{className:"font-medium text-gray-700",children:"Política de Privacidade"})]}),e.jsx(p,{className:"text-lg text-gray-400"})]}),e.jsxs("button",{onClick:m,className:"flex items-center justify-between w-full py-3 px-2 rounded-lg hover:bg-gray-50 transition-colors","aria-label":"Ver termos de serviço",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"text-indigo-600 text-xl mr-3"}),e.jsx("span",{className:"font-medium text-gray-700",children:"Termos de Serviço"})]}),e.jsx(p,{className:"text-lg text-gray-400"})]}),e.jsxs("button",{onClick:d,className:"flex items-center justify-between w-full py-3 px-2 rounded-lg hover:bg-gray-50 transition-colors","aria-label":"Entrar em contato com o suporte",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"text-teal-600 text-xl mr-3"}),e.jsx("span",{className:"font-medium text-gray-700",children:"Suporte"})]}),e.jsx(p,{className:"text-lg text-gray-400"})]})]}),e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-sm",children:e.jsxs("button",{onClick:n,className:"flex items-center w-full py-3 px-2 text-red-600 font-medium rounded-lg hover:bg-red-50 transition-colors","aria-label":"Sair da conta",children:[e.jsx(D,{className:"text-xl mr-3"}),"Sair"]})})]})};export{U as Profile};
//# sourceMappingURL=Profile-DsVRqPRb.js.map
